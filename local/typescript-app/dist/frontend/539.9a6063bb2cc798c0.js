"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[539],{4539:(y,h,a)=>{a.r(h),a.d(h,{UserModule:()=>T});var p=a(6895),l=a(8184);class v{}var U=a(2838),o=a(433),i=a(2340),e=a(1571),Z=a(892),f=a(3317);let w=(()=>{class n{constructor(t,r,s){this.authService=t,this.router=r,this.alerts=s,this.oauth2=new v,this.userLogin=new U.K,this.loginForm=new o.cw({email:new o.NI("username",[o.kI.required]),password:new o.NI("password",[o.kI.required,o.kI.minLength(4),o.kI.maxLength(8)])})}ngOnInit(){window.scroll(0,0)}login(){const t=this.userLogin;this.authService.getInfoFromUserUsername(this.userLogin.username).subscribe({next:r=>{null==r?(console.log("User not found!"),this.router.navigate(["/auth/signin"]),this.alerts.showAlertDanger("User not found! Sign-in first")):this.authService.getUserLogged(t.username).subscribe({next:s=>{null!=s?(console.log("User found, has logged:"),i.N.id=s.id,i.N.firstName=s.firstname,i.N.lastName=s.lastname,i.N.username=s.username,this.authService.tokenOauth2(this.userLogin.username,this.userLogin.password).subscribe({next:g=>{let d=JSON.stringify(g),c=JSON.parse(d);this.token=c.access_token,this.userLogin.token=this.token,i.N.token=this.token,t.token=this.token,this.authService.updateUserLogged(i.N.id,t).subscribe({next:m=>{i.N.isLogged=!0,this.router.navigate(["/home"]),this.alerts.showAlertSuccess("User Logged-in!")}})}})):(console.log("User never logged"),this.authService.tokenOauth2(this.userLogin.username,this.userLogin.password).subscribe({next:g=>{let d=JSON.stringify(g),c=JSON.parse(d);this.token=c.access_token,this.userLogin.token=this.token,this.authService.getInfoFromUserUsername(this.userLogin.username).subscribe({next:m=>{i.N.token=this.token,i.N.firstName=m.firstName,i.N.lastName=m.lastName,i.N.username=m.email,t.firstname=m.firstName,t.token=this.token,this.authService.salvarLogin(t).subscribe({next:k=>{i.N.isLogged=!0,i.N.id=k.id,this.router.navigate(["/home"]),this.alerts.showAlertSuccess("User Logged-in!")}})}})}}))}})}})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Z.e),e.Y36(l.F0),e.Y36(f.m))},n.\u0275cmp=e.Xpm({type:n,selectors:[["login"]],decls:25,vars:3,consts:[[1,"container-fluid"],[1,"row","d-flex","align-items-center"],[1,"col-md-6"],[1,"row","d-flex","justify-content-center"],[1,"col-md-10"],[1,"text-center","fw-bold","mb-3"],[1,"d-flex","justify-content-center"],["src","https://i.imgur.com/LGGL7VJ.png",1,"img-login"],[3,"formGroup","ngSubmit"],["for","username",1,"mt-3"],["type","text","formControlName","email",1,"form-control",3,"ngModel","ngModelChange"],["for","password",1,"mt-1"],["type","password","formControlName","password",1,"form-control",3,"ngModel","ngModelChange"],[1,"d-grid"],["type","submit",1,"btn","btn-primary","mt-3"],[1,"mt-5","mb-5"],[1,"text-center","mb-5"],["routerLink","/auth/signin"],["id","img-bg",1,"col-md-6"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h1",5),e._uU(6,"Login"),e.qZA(),e.TgZ(7,"div",6),e._UZ(8,"img",7),e.qZA(),e.TgZ(9,"form",8),e.NdJ("ngSubmit",function(){return r.login()}),e.TgZ(10,"label",9),e._uU(11,"Username:"),e.qZA(),e.TgZ(12,"input",10),e.NdJ("ngModelChange",function(g){return r.userLogin.username=g}),e.qZA(),e.TgZ(13,"label",11),e._uU(14,"Password:"),e.qZA(),e.TgZ(15,"input",12),e.NdJ("ngModelChange",function(g){return r.userLogin.password=g}),e.qZA(),e.TgZ(16,"div",13)(17,"button",14),e._uU(18,"Enter"),e.qZA()()(),e._UZ(19,"hr",15),e.TgZ(20,"p",16),e._uU(21," N\xe3o tem uma conta ainda? "),e.TgZ(22,"a",17),e._uU(23,"Cadastre-se"),e.qZA()()()()(),e._UZ(24,"div",18),e.qZA()()),2&t&&(e.xp6(9),e.Q6J("formGroup",r.loginForm),e.xp6(3),e.Q6J("ngModel",r.userLogin.username),e.xp6(3),e.Q6J("ngModel",r.userLogin.password))},dependencies:[o._Y,o.Fj,o.JJ,o.JL,o.sg,o.u,l.yS],styles:["#img-bg[_ngcontent-%COMP%]{background-image:url(https://i.imgur.com/fYB70g7.jpg);min-height:1000px;background-position:center;background-repeat:no-repeat;background-size:cover}.img-login[_ngcontent-%COMP%]{width:380px;height:360px}"]}),n})();class N{}var b=a(529);let L=(()=>{class n{constructor(t){this.http=t,this.apiUrl=i.N.apiUrl}salvar(t){return this.http.post(this.apiUrl+"/auth/signin",t)}listar(){return this.http.get(this.apiUrl)}deletar(t){const r=`${this.apiUrl}${t}`;return console.log(r),this.http.delete(r)}elevarPermission(t){return this.http.patch(`${this.apiUrl}${t}/admin`,{})}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(b.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const S=[{path:"login",component:w},{path:"signin",component:(()=>{class n{constructor(t,r,s){this.userService=t,this.router=r,this.alerts=s,this.user=new N,this.userForm=new o.cw({email:new o.NI("user",[o.kI.required]),password:new o.NI("pass",[o.kI.required,o.kI.minLength(4),o.kI.maxLength(8)]),firstName:new o.NI("firstname",[o.kI.required]),lastName:new o.NI("lastname",[o.kI.required])})}ngOnInit(){window.scroll(0,0)}confirmPass(t){this.confirmPassword=t.target.value}submit(){if(this.user.password!=this.confirmPassword)this.alerts.showAlertDanger("Password don't match!");else{const t={...this.userForm.value};this.userService.salvar(t).subscribe(r=>{this.userForm.reset(),this.router.navigate(["/auth/login"]),this.alerts.showAlertSuccess("User created!")})}}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(L),e.Y36(l.F0),e.Y36(f.m))},n.\u0275cmp=e.Xpm({type:n,selectors:[["signin"]],decls:32,vars:2,consts:[[1,"container-fluid"],[1,"row","d-flex","align-items-center"],["id","img-bg",1,"col-md-6"],[1,"col-md-6"],[1,"row","d-flex","justify-content-center"],[1,"col-md-10"],[1,"text-center","mt-2","mb-3"],[1,"d-flex","justify-content-center"],["src","https://i.imgur.com/LGGL7VJ.png",1,"img-login"],[3,"formGroup","ngSubmit"],[1,"row"],[1,"mt-1"],["type","text","formControlName","firstName",1,"form-control"],["type","text","formControlName","lastName",1,"form-control"],["type","text","formControlName","email",1,"form-control"],["type","password",1,"form-control",3,"input"],["type","password","formControlName","password",1,"form-control",3,"ngModel","ngModelChange"],[1,"d-grid"],["type","submit",1,"btn","btn-primary","mt-3"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"div",2),e.TgZ(3,"div",3)(4,"div",4)(5,"div",5)(6,"h1",6),e._uU(7,"Sign in"),e.qZA(),e.TgZ(8,"div",7),e._UZ(9,"img",8),e.qZA(),e.TgZ(10,"form",9),e.NdJ("ngSubmit",function(){return r.submit()}),e.TgZ(11,"div",10)(12,"div",3)(13,"label",11),e._uU(14,"Firstname:"),e.qZA(),e._UZ(15,"input",12),e.qZA(),e.TgZ(16,"div",3)(17,"label",11),e._uU(18,"Lastname:"),e.qZA(),e._UZ(19,"input",13),e.qZA()(),e.TgZ(20,"label",11),e._uU(21,"Username:"),e.qZA(),e._UZ(22,"input",14),e.TgZ(23,"label",11),e._uU(24,"Password:"),e.qZA(),e.TgZ(25,"input",15),e.NdJ("input",function(g){return r.confirmPass(g)}),e.qZA(),e.TgZ(26,"label",11),e._uU(27,"Confirm password:"),e.qZA(),e.TgZ(28,"input",16),e.NdJ("ngModelChange",function(g){return r.user.password=g}),e.qZA(),e.TgZ(29,"div",17)(30,"button",18),e._uU(31,"Save"),e.qZA()()()()()()()()),2&t&&(e.xp6(10),e.Q6J("formGroup",r.userForm),e.xp6(18),e.Q6J("ngModel",r.user.password))},dependencies:[o._Y,o.Fj,o.JJ,o.JL,o.sg,o.u],styles:["#img-bg[_ngcontent-%COMP%]{background-image:url(https://i.imgur.com/fYB70g7.jpg);min-height:1000px;background-position:center;background-repeat:no-repeat;background-size:cover}.img-login[_ngcontent-%COMP%]{width:380px;height:360px}"]}),n})()},{path:"",pathMatch:"full",redirectTo:"login"}];let C=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[p.ez,l.Bz.forChild(S),l.Bz]}),n})(),T=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[p.ez,o.UX,C,o.u5]}),n})()}}]);